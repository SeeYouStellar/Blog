## 一、概述

### 操作系统特征

1. 并发性：并发是通过**分时**得以实现的。同一时间间隔内执行多个任务叫并发，同一时刻执行多个任务叫并行。每个操作系统都有并发性，但不是每个操作系统都有并行性。**单处理器系统只能做到同一间隔内宏观上同时执行多任务，在微观上仍然是交替进行每个任务。**
2. 共享性：系统中的资源供多个并发进程共同使用。包括互斥共享和同时访问。
3. 虚拟性：把一个物理上的实体变为若干逻辑上的对应物。例如时分复用，虚拟内存等。
4. 异步性：多道程序环境，进程的推进是不可预测的，多个进程的完成可能是按照多个时间片顺序完成的。

### 并发与并行的区别

并发是通过**分时**得以实现的。同一时间间隔内执行多个任务叫并发，同一时刻执行多个任务叫并行。每个操作系统都有并发性，但不是每个操作系统都有并行性。**单处理器系统只能做到同一间隔内宏观上同时执行多任务，在微观上仍然是交替进行每个任务。**

### 异步与同步的区别

同步是将任务按顺序交给cpu，并且按顺序完成任务；异步是将很多任务同时交给cpu，cpu完成任务的顺序有可能不是按顺序的。

### 操作系统种类

1. 单道批处理
2. 多道批处理
3. 分时系统
4. 实时系统

### 操作系统运行环境

操作系统有两个运行模式：用户态（可调用非特权指令）和内核态（可调用特权指令），这只是cpu的两个状态

**模式切换不一定有进程切换，进程切换一定有模式切换**，为什么？

操作系统在用户态执行进程时，遇到中断、陷阱、系统调用等可使进程切换的情况时，需要保存操作系统运行上下文到进程的PCB中，而这里涉及到的指令（存取寄存器的值）是特权指令，是内核态操作系统才能完成的，故必须切换模式。

上述模式切换需要使用中断，**中断**是一些打断cpu执行指令顺序的事件。

中断分类：

![请添加图片描述](https://img-blog.csdnimg.cn/abed3d4334204667870e3aaab73db310.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80MzE4MDQ4NA==,size_16,color_FFFFFF,t_70)

###  系统调用和中断的区别

系统调用是程序在运行过程中发出的指令，这些指令激活某些cpu内核例程，包括各种io指令、进程、线程调度指令。所以既然要去执行另外的内核例程，就会有进程切换，所以也会有模式切换。

系统调用具体指的是系统内核包装的一些硬件指令和硬件状态，又称为内核函数，以接口的形式提供给用户调用，所以称为系统调用。

系统调用过程：系统通过陷阱（trap）——一种特殊的硬件指令，硬件将控制转移到预先指定的陷阱处理程序，并同时从用户态转移到内核态。接着cpu运行某些内核例程。完成后，cpu通过陷阱返回指令将控制权返回。

中断是某些运行程序之外的事件。

###  编译与解释

将高级语言直接翻译成机器语言的程序软件叫**翻译程序**

1. **编译**：将一种语言编写的程序全部翻译成另一种语言，然后再执行； 

2. **解释**：将一种语言编写的程序的一条语句翻译成另一种语言的一条或多条语句，然后执行，执行完这条语言后，再解释下一条。

### 冯诺依曼机器的主要特点

1）计算机由运算器、存储器、控制器、输入设备和输出设备五大部分组成； 2）指令和数据存储在存储器中，并可以按地址访问； 3）指令和数据均以二进制表示； 4）指令由操作码和地址码构成，操作码指明操作的性质，地址码表示操作数在存储器中的位置； 5）指令在存储器内按顺序存放，通常按自动的顺序取出执行； 6）机器以运算器为中心，I/O设备与存储器交换数据也要通过运算器。

## 二、并发-同步与互斥

### 进程之间通信方式

1. 套接字：不同机器之间的进程通信
2. 共享内存
3. 信号量：使用计数的方式保护临界区，实现进程之间的同步和互斥
4. 管道：父子进程之间

## 三、死锁

## 四、内存/虚拟内存

### Cache和TLB的区别

两者都是高速缓存，前者用来加快内存块的访问，后者用于虚拟地址与物理地址的转换

TLB又叫转换检测缓冲区，每个表项由虚拟页号、页框号（页框号是物理地址的范畴）与其他组成，且TLB与页表不同，不是按页号顺序来存储每个表项，而是乱序的（故其查找是通过硬件完成：同时查找多个虚拟页号）。找到对应页框号再与虚拟地址中的偏移量结合就得到了物理地址。

### cpu读取内存单元的过程

1. 根据pc程序计数器中的地址找到内存中的某条存取指令
2. 将该单元放入IR指令寄存器
3. 接着通过指令译码器解析指令的操作码，然后将发出控制信息
4. 将指令中的地址字段取出放入地址缓冲寄存器AR，该字段就是虚拟地址，将虚拟地址分成页号和偏移量
5. 在TLB中查找该页号，若该页号存在则将该页号对应的页框号和偏移量结合，就得到了物理地址，若未找到则继续访问页表或段表，转到7
6. 根据物理地址查找内存单元时，先访问cache，若cache中有该字，则直接将该字通过数据总线送给cpu，若cache中没有该字，则继续访问内存，并通过LRU或者LFU将内存中的一块放入cache中
7. 页表项包含页框号和存在位等等，根据内存中的页表基址遍历页表，若该页号所指页表项存在位为1，则同样找到物理地址，转到6；若存在为0，则发起缺页中断，说明该字不在内存中，需从辅存中取出。此时涉及到虚拟内存的置换策略，驻留集管理，清楚策略。缺页中断后将该页放入内存中并更新页表、TLB、cache

### LRU、LFU

LRU：最近最少使用。替换最长时间未使用的块

LFU：最不经常使用。替换一段时间内使用次数最少的块
